<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Famms Admin - Decap CMS</title>
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.css" />
    <!-- Netlify Identity Widget -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            background-color: #fff;
        }
    </style>
</head>
<body>
    <div id="nc-root"></div>
    <div style="position: fixed; top: 20px; right: 20px; z-index: 1000;">
        <button onclick="handleLogout()" style="background: #e74c3c; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600;">
            ðŸšª Logout
        </button>
    </div>
    <script>
        // Initialize Decap CMS with git-gateway backend for production
        CMS.init({
            config: {
                backend: {
                    name: 'git-gateway',
                    branch: 'master'
                },
                publish_mode: "editorial_workflow",
                media_folder: "images/uploads",
                public_folder: "/images/uploads",
                logo_url: "/images/logo.png",
                collections: [
                    {
                        name: "about",
                        label: "About Page",
                        files: [
                            {
                                name: "about",
                                label: "About Us Page",
                                file: "content/about.json",
                                fields: [
                                    { label: "Hero Title", name: "hero_title", widget: "string", default: "About Famms" },
                                    { label: "Hero Subtitle", name: "hero_subtitle", widget: "string", default: "Your Trusted Fashion Partner Since 2020" },
                                    { label: "Hero Description", name: "hero_description", widget: "text", default: "We are dedicated to providing high-quality fashion products that combine style, comfort, and affordability for the modern consumer." },
                                    { label: "Story Title", name: "story_title", widget: "string", default: "Our Story" },
                                    { label: "Story Subtitle", name: "story_subtitle", widget: "string", default: "From a small idea to a fashion destination" },
                                    { label: "Story Content", name: "story_content", widget: "text", default: "Founded in 2020, Famms began as a small boutique with a big vision: to make quality fashion accessible to everyone." },
                                    { label: "Story Content 2", name: "story_content_2", widget: "text", default: "Our journey has been driven by passion for fashion and commitment to customer satisfaction." },
                                    { label: "Story Content 3", name: "story_content_3", widget: "text", default: "Today, Famms stands as a testament to what can be achieved with dedication, hard work, and a genuine love for fashion." },
                                    { label: "Gallery Title", name: "gallery_title", widget: "string", default: "Our Gallery" },
                                    { label: "Gallery Subtitle", name: "gallery_subtitle", widget: "string", default: "Explore our collection" },
                                    { label: "Gallery Images", name: "gallery_images", widget: "list", field: { label: "Image", name: "image", widget: "image", required: false } },
                                    { label: "CTA Title", name: "cta_title", widget: "string", default: "Ready to Experience the Famms Difference?" },
                                    { label: "CTA Description", name: "cta_description", widget: "text", default: "Join thousands of satisfied customers who have discovered their perfect style with us." }
                                ]
                            }
                        ]
                    },
                    {
                        name: "products",
                        label: "Products",
                        folder: "content/products",
                        create: true,
                        slug: "{{slug}}",
                        fields: [
                            { label: "Title", name: "title", widget: "string" },
                            { label: "Price", name: "price", widget: "string" },
                            { label: "Image", name: "image", widget: "image" },
                            { label: "Category", name: "category", widget: "select", options: ["Men", "Women", "Kids", "Accessories"] },
                            { label: "Description", name: "description", widget: "text", required: false },
                            { label: "WhatsApp", name: "whatsapp", widget: "string", hint: "Format: 628123456789" }
                        ]
                    },
                    {
                        name: "site_settings",
                        label: "Site Settings",
                        files: [
                            {
                                name: "settings",
                                label: "General Settings",
                                file: "content/settings.json",
                                fields: [
                                    { label: "Store Name", name: "store_name", widget: "string", default: "Famms" },
                                    { label: "Store Description", name: "store_description", widget: "text", required: false },
                                    { label: "WhatsApp Number", name: "whatsapp_number", widget: "string", default: "628123456789" },
                                    { label: "Instagram URL", name: "instagram_url", widget: "string", default: "#" },
                                    { label: "Facebook URL", name: "facebook_url", widget: "string", default: "#" },
                                    { label: "Twitter URL", name: "twitter_url", widget: "string", default: "#" },
                                    { label: "LinkedIn URL", name: "linkedin_url", widget: "string", default: "#" },
                                    { label: "Pinterest URL", name: "pinterest_url", widget: "string", default: "#" },
                                    { label: "Address", name: "address", widget: "string", default: "Your Store Address" },
                                    { label: "Phone", name: "phone", widget: "string", default: "+01 1234567890" },
                                    { label: "Email", name: "email", widget: "string", default: "demo@gmail.com" }
                                ]
                            }
                        ]
                    },
                    {
                        name: "testimonials",
                        label: "Testimonials",
                        folder: "content/testimonials",
                        create: true,
                        slug: "{{slug}}",
                        fields: [
                            { label: "Name", name: "name", widget: "string" },
                            { label: "Role", name: "role", widget: "string" },
                            { label: "Content", name: "content", widget: "text" },
                            { label: "Image", name: "image", widget: "image", default: "images/client.jpg" },
                            { label: "Rating", name: "rating", widget: "number", default: 5, min: 1, max: 5 }
                        ]
                    },
                    {
                        name: "gallery",
                        label: "Gallery",
                        folder: "content/gallery",
                        create: true,
                        slug: "{{slug}}",
                        fields: [
                            { label: "Title", name: "title", widget: "string" },
                            { label: "Image", name: "image", widget: "image" },
                            { label: "Category", name: "category", widget: "select", options: ["Fashion", "Products", "Store", "Events"] },
                            { label: "Alt Text", name: "alt_text", widget: "string", required: false }
                        ]
                    }
                ]
            }
        });
        
        // Handle authentication and redirect
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on('init', user => {
                if (!user) {
                    // User not logged in, redirect to login page
                    window.location.href = '/admin/login.html';
                } else {
                    // User logged in, show CMS
                    console.log('User authenticated:', user);
                }
            });
            
            window.netlifyIdentity.on('logout', () => {
                // User logged out, redirect to login page
                window.location.href = '/admin/login.html';
            });
        } else {
            // Netlify Identity not available, redirect to login
            window.location.href = '/admin/login.html';
        }
        
        function handleLogout() {
            if (window.netlifyIdentity) {
                window.netlifyIdentity.logout();
            }
        }
    </script>
</body>
</html>
